<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.557">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="ARCHIVED">
<meta name="dcterms.date" content="2024-08-09">

<title>tom savage - Metaphysical Chemical Processes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tom savage</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Metaphysical Chemical Processes</h1>
            <p class="subtitle lead">I think, therefore Aram-co</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>ARCHIVED </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 9, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>The Chinese room thought experiment provides an argument for why computers will never be able to truly ‘think’ <span class="citation" data-cites="searle">(<a href="#ref-searle" role="doc-biblioref">Moural 2003</a>)</span>. In effect it states that a machine can be <em>seen</em> to be providing intelligent dialogue or conversation in Chinese, but inside ‘the room’ there is simply someone with a rule book that is large enough to enumerate all the potential answers, and the rules to generate and combine them (in effect, the <em>structure</em> of Chinese). This person doesn’t truly know or think about what they are doing. Whether or not this is a realistic analogy is not something I am going to attempt to answer. To me, the Chinese room, with it’s counter and counter-counter-arguments <span class="citation" data-cites="boden1990philosophy">(<a href="#ref-boden1990philosophy" role="doc-biblioref">Boden 1990</a>)</span>, is relatively convincing.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="ref-searle" class="csl-entry" role="listitem">
Moural, Josef. 2003. <span>“The Chinese Room Argument.”</span> In <em>John Searle</em>, edited by BarryEditor Smith, 214–60. Contemporary Philosophy in Focus. Cambridge University Press.
</div><div id="ref-boden1990philosophy" class="csl-entry" role="listitem">
Boden, Margaret A. 1990. <em>The Philosophy of Artificial Intelligence</em>. Oxford University Press, Inc.
</div><div id="fn1"><p><sup>1</sup>&nbsp;I also like the implication that if the Chinese room is correct, then either the human brain with it’s electrical and chemical signals is somewhat ‘special’ and has some additional latent features that invoke conciousness/intuition/thought, <em>or</em> conciousness/intuition is actually just a bit of an illusion and there’s nothing to distinguish us from a bloke idly following instructions without understanding what they mean. Both equally fun.</p></div></div><p>But for the purposes of this post, I’m not convinced, I think it’s all wrong.</p>
<p>Here’s a quote that I enjoy from the <a href="https://plato.stanford.edu/entries/chinese-room/">Stanford Encyclopedia of Philosophy</a> with an interesting extension to the thought experiment.</p>
<div class="cleanbox">
<p>[…] He [Searle] suggests a variation on the brain simulator scenario: suppose that in the room the man has a huge set of valves and water pipes, in the same arrangement as the neurons in a native Chinese speaker’s brain. The program now tells the man which valves to open in response to input. Searle claims that it is obvious that there would be no understanding of Chinese. (Note however that the basis for this claim is no longer simply that Searle himself wouldn’t understand Chinese – it seems clear that now he is just facilitating the causal operation of the system and so we rely on our Leibnizian intuition that water-works don’t understand (see also Maudlin 1989).) Searle concludes that a simulation of brain activity is not the real thing.</p>
</div>
<p>It’s a good point, water-works can’t think, can they? If a brain can think, and a brain can be modelled like a series of pipes, then why can’t a series of pipes think? If I were to replace a single pipe with an actual real neuron, the signal of which controlled a valve to the next pipe, then would my water-works<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> be able to think? If I just start replacing all the pipes in my works with equivalent neurons, <em>at what point does conciousness kick in?</em> <span class="citation" data-cites="maudlin1989">(<a href="#ref-maudlin1989" role="doc-biblioref">Maudlin 1989</a>)</span></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;spoiler alert, or… chemical processes.</p></div><div id="ref-maudlin1989" class="csl-entry" role="listitem">
Maudlin, Tim. 1989. <span>“Computation and Consciousness.”</span> <em>The Journal of Philosophy</em> 86 (8): 407–32.
</div><div id="ref-schwitzgebel2014" class="csl-entry" role="listitem">
Schwitzgebel, Eric. 2014. <span>“If Materialism Is True, the United States Is Probably Conscious.”</span> <em>Philosophical Studies</em> 172 (7): 1697–1721. <a href="https://doi.org/10.1007/s11098-014-0387-8">https://doi.org/10.1007/s11098-014-0387-8</a>.
</div><div id="fn3"><p><sup>3</sup>&nbsp;This is almost certainly true when you look at Joe Biden; the US still <em>works</em> even if the man in charge is barely with us.</p></div><div id="fn4"><p><sup>4</sup>&nbsp;Normal people will and have used neural networks to attempt this task, choosing to (originally) directly model the interactions between neurons. I’m going to choose to model the water-works, because, funny.</p></div><div id="fn5"><p><sup>5</sup>&nbsp;I might spin this off into a deeptech unicorn.</p></div></div><p>There’s a nice paper that touches on that last point justifying the idea that large organisations, or <em>countries</em> such as the United States can (or rather are) concious <span class="citation" data-cites="schwitzgebel2014">(<a href="#ref-schwitzgebel2014" role="doc-biblioref">Schwitzgebel 2014</a>)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> With that in mind, I’ll get to the point. Can we design a chemical process to think?<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> The fact I’ll be dealing with simulated chemical processes adds a layer of complication because we’re back to asking whether computers can think. But lets assume I’m going to end up building it.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<section id="the-plan" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-plan">The plan</h3>
<p>How am I going to go about this task? I could cheat and try to model a <em>neural network</em> using a chemical process. After all, neural networks have been proven to be universal function approximators<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. I think this is a bit of a boring and sort of cheating. Additionally, attempting to directly find a chemical process that can reason is more interesting than finding a neural network that can reason, because I could feasibly go and build the chemical process in the real world<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. The system it would live in is the same as us (i.e.&nbsp;not within the confines of a computer). However, in the ‘lets try to get a neural network to think’-space inherently it still just exists on a computer and you’re back to square one<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. You’d have to make the neural network into some physical representation (like a brain)<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;Apparently to the detriment of machine learning as a field, something about making people focus on the wrong aspects of research.</p></div><div id="fn7"><p><sup>7</sup>&nbsp;I could also build the chemical process that approximates a neural network but as I say, boring.</p></div><div id="fn8"><p><sup>8</sup>&nbsp;Or at least a less interesting metaphysical representation.</p></div><div id="fn9"><p><sup>9</sup>&nbsp;This is somewhat similar to the <a href="https://www.aria.org.uk/nature-computes-better-seeds/">ARIA project <em>Nature Computes Better</em></a></p></div></div><p>Quite obviously, the first reasonable step to building a chemical process that can think, is to build a chemical process simulator.</p>
</section>
<section id="building-a-process-simulator" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="building-a-process-simulator">Building a Process Simulator</h3>
<p>Existing process simulators are bloated, use outdated GUIs and are not built with machine learning / data-driven workflows in mind. So I built my own. It’s currently written in Python but it might not be one day<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. I’ve called it <code>&lt;process&gt;</code>, which you <strong>have</strong> to write as a code block.</p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>&nbsp;LLM-based code-translation will solve this for me.</p></div><div id="fn11"><p><sup>11</sup>&nbsp;I can’t stress how much better and more useful this is over SFILES workflows <span class="citation" data-cites="vogel2023">(<a href="#ref-vogel2023" role="doc-biblioref">Vogel et al. 2023</a>)</span> which are outdated and stuck in an era where NLP worked on sentences and LLMs that could parse millions of tokens at a time didn’t exist. How are you seriously meant to learn a representation of something as intricate as a chemical process with an abstraction like <code>(raw)(hex)(r)[&lt;(pp)&lt;(raw)](mix)&lt;...</code>. Unless you train an LLM from scratch on SFILES (spoiler: you can’t because there is no where near enough data) they’re completely useless to use as a representation, because SFILEs are 1. not in LLM datasets (cannot truly use with pretrained LLMs) and 2. pretrained LLMs will struggle to one-shot learn what SFILES is because they’re not easily understandable, parseable or readable. LLMs are a learned representation of language, if you’re going to try and use them for chemical processes, or want a useable process representation then express them using language. SFILES rant over.</p><div id="ref-vogel2023" class="csl-entry" role="listitem">
Vogel, Gabriel, Edwin Hirtreiter, Lukas Schulze Balhorn, and Artur M. Schweidtmann. 2023. <span>“SFILES 2.0: An Extended Text-Based Flowsheet Representation.”</span> <em>Optimization and Engineering</em> 24 (4): 2911–33. <a href="https://doi.org/10.1007/s11081-023-09798-9">https://doi.org/10.1007/s11081-023-09798-9</a>.
</div></div><div id="fn12"><p><sup>12</sup>&nbsp;Insert OntoCAPE rant.</p></div><div id="fn13"><p><sup>13</sup>&nbsp;Apart from the silly long previous rant. </p></div><div id="fn14"><p><sup>14</sup>&nbsp;I only use TOML over YAML because it’s called <em>Tom’s Own Markup Language</em> and that is my name. These are the arbitary decisions I have and will continue to make throughout this post.</p></div></div><p>In <code>&lt;process&gt;</code>, processes are fully represented within a TOML file. The files are detailed enough to provide a complete representation of a process<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>. The representation is also not too detailed where there would be extraneous effort to define it, reducing bloat<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>. If you’re far enough into process design that you want to model a process in significant detail then ‘rigorous’ tools such as Aspen or gProms are what you want anyway. <code>&lt;process&gt;</code> is not for rigorous design, it sits somewhere between SFILES, and Aspen in terms of complexity. It’s main advantage over SFILES<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>is that chemical processes can be simulated <strong>directly</strong> from an interpretable text-based <code>toml</code> file<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>. <code>&lt;process&gt;</code> is effectively a compiler for chemical processes, compiling a readable text-based format into an object that can be simulated and analysed.</p>
<p>Here’s an example <code>process.toml</code> file.</p>
<details>
<summary>
Show <code>process.toml</code> file…
</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[species]]</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"water"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">molecular_weight</span> <span class="op">=</span> <span class="fl">18.01528</span> <span class="co"># kg/kmol</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dt">cp_poly_coeffs</span> <span class="op">=</span> <span class="op">[</span><span class="fl">276370.0</span><span class="op">,</span> <span class="fl">-2090.1</span><span class="op">,</span> <span class="fl">8.125</span><span class="op">,</span> <span class="fl">-0.014116</span><span class="op">,</span> <span class="fl">9.3701e-6</span><span class="op">]</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">enthalpy_of_formation</span> <span class="op">=</span> <span class="fl">-285830.0</span> <span class="co"># kJ/kmol</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">[[species]]</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"benzene"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="dt">molecular_weight</span> <span class="op">=</span> <span class="fl">78.11</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="dt">cp_poly_coeffs</span> <span class="op">=</span> <span class="op">[</span><span class="fl">162940.0</span><span class="op">,</span><span class="fl">-344.94</span><span class="op">,</span><span class="fl">0.85562</span><span class="op">]</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="dt">enthalpy_of_formation</span> <span class="op">=</span> <span class="fl">48950.0</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">[[species]]</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"nitric_acid"</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="dt">molecular_weight</span> <span class="op">=</span> <span class="fl">63.013</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="dt">cp_poly_coeffs</span> <span class="op">=</span> <span class="op">[</span><span class="fl">131250.0</span><span class="op">,</span><span class="fl">-121.9</span><span class="op">,</span><span class="fl">0.1704</span><span class="op">]</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="dt">enthalpy_of_formation</span> <span class="op">=</span> <span class="fl">-169100.0</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">[[species]]</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"nitro_benzene"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="dt">molecular_weight</span> <span class="op">=</span> <span class="fl">123.109</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="dt">cp_poly_coeffs</span> <span class="op">=</span> <span class="op">[</span><span class="fl">295300.0</span><span class="op">,</span><span class="fl">-80.7</span><span class="op">,</span><span class="fl">1.705</span><span class="op">]</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="dt">enthalpy_of_formation</span> <span class="op">=</span> <span class="fl">12500.0</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"benzene_inlet"</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_flowrate</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># kmol</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_ratios</span> <span class="op">=</span> <span class="op">{</span><span class="dt">benzene</span><span class="op"> =</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="dt">temperature</span> <span class="op">=</span> <span class="dv">298</span> <span class="co"># K </span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="dt">pressure</span> <span class="op">=</span> <span class="dv">101325</span> <span class="co"># Pa</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"nitric_acid_inlet"</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_flowrate</span> <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_ratios</span> <span class="op">=</span> <span class="op">{</span><span class="dt">nitric_acid</span><span class="op"> =</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="dt">temperature</span> <span class="op">=</span> <span class="dv">312</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="dt">pressure</span> <span class="op">=</span> <span class="dv">101325</span> <span class="co"># Pa</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"reactor_products"</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"reactor_products_cooled"</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"reactor_reactants"</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"final_product"</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"tops"</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"waste_water"</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"pure_product"</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"benzene_recycle"</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_flowrate</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_ratios</span> <span class="op">=</span> <span class="op">{</span><span class="dt">benzene</span><span class="op"> =</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="dt">temperature</span> <span class="op">=</span> <span class="dv">298</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="dt">pressure</span> <span class="op">=</span> <span class="dv">101325</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"recycle"</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_flowrate</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_ratios</span> <span class="op">=</span> <span class="op">{</span><span class="dt">water</span><span class="op"> =</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="dt">temperature</span> <span class="op">=</span> <span class="dv">298</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="dt">pressure</span> <span class="op">=</span> <span class="dv">101325</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="kw">[[separator]]</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"separator_one"</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"final_product"</span><span class="op">]</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"tops"</span><span class="op">,</span> <span class="st">"waste_water"</span><span class="op">]</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="dt">spec</span> <span class="op">=</span> <span class="op">[{</span><span class="dt">nitro_benzene</span><span class="op">=</span> <span class="fl">0.95</span><span class="op">},{</span><span class="dt">water</span><span class="op">=</span> <span class="fl">0.95</span><span class="op">}]</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="kw">[[separator]]</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"separator_two"</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"tops"</span><span class="op">]</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"pure_product"</span><span class="op">,</span> <span class="st">"benzene_recycle"</span><span class="op">]</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="dt">spec</span> <span class="op">=</span> <span class="op">[{</span><span class="dt">nitro_benzene</span><span class="op">=</span> <span class="fl">0.99</span><span class="op">},{</span><span class="dt">benzene</span><span class="op"> =</span> <span class="fl">0.95</span><span class="op">}]</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="kw">[[mixer]]</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"reactant_mixer"</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"benzene_inlet"</span><span class="op">,</span> <span class="st">"nitric_acid_inlet"</span><span class="op">,</span><span class="st">"recycle"</span><span class="op">,</span><span class="st">"benzene_recycle"</span><span class="op">]</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"reactor_reactants"</span><span class="op">]</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="kw">[[reactor]]</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"reactor_one"</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"reactor_reactants"</span><span class="op">]</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"reactor_products"</span><span class="op">]</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="dt">reactant_stoichiometry</span> <span class="op">=</span> <span class="op">{</span><span class="dt">benzene</span><span class="op">=</span><span class="dv">1</span><span class="op">, </span><span class="dt">nitric_acid</span><span class="op">=</span><span class="dv">1</span><span class="op">}</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="dt">product_stoichiometry</span> <span class="op">=</span> <span class="op">{</span><span class="dt">water</span><span class="op"> =</span> <span class="dv">1</span><span class="op">, </span><span class="dt">nitro_benzene</span><span class="op"> =</span><span class="dv">1</span><span class="op">}</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="dt">conversion</span> <span class="op">=</span> <span class="op">{</span><span class="dt">benzene</span><span class="op">=</span><span class="fl">0.9</span><span class="op">}</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="kw">[[splitter]]</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"splitter_one"</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"reactor_products_cooled"</span><span class="op">]</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"final_product"</span><span class="op">,</span> <span class="st">"recycle"</span><span class="op">]</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="dt">split_ratio</span> <span class="op">=</span> <span class="op">[</span><span class="fl">0.8</span><span class="op">,</span> <span class="fl">0.2</span><span class="op">]</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="kw">[[heat_exchanger]]</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"product_cooler"</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"reactor_products"</span><span class="op">]</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"reactor_products_cooled"</span><span class="op">]</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet_temperature</span> <span class="op">=</span> <span class="dv">298</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>By design, it’s relatively self-explanatory. You define molecular species, all the streams, their connections, etc. Unit operations each have specific attributes which must be defined such as the split ratio of a splitter. You don’t have to specify everything<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>, <code>&lt;process&gt;</code> will attempt to simulate unit operations with specified inlet streams until the entire process converges. Degrees-of-freedom are currently quite uncompromising. There is no way to fix a stream, and every variable can be changed. There is no need for a specific ‘recycle’ block or stream due to the way a process is converged. At the expense of bloat, you have to pay slightly more attention to what is being defined, which is not the worst trade off.</p>
<div class="no-row-height column-margin column-container"><div id="fn15"><p><sup>15</sup>&nbsp;If you could then this would be a pointless tool.</p></div></div><p>Anyway, I might write this up a bit longer at some point depending if I flesh it out a bit. For now, onwards…</p>
<p>I can visualise a process as follows:</p>
<div id="e4d89639" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>process_file <span class="op">=</span> <span class="st">"nitrobenzene_process.toml"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>process <span class="op">=</span> parse_process(process_file)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>process.plot(<span class="st">"outputs/process.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="process.png" class="img-fluid figure-img"></p>
<figcaption>A visualised process.</figcaption>
</figure>
</div>
</div></div><p>And simulate it as so:</p>
<div id="6fe19b9c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>process.simulate(tol<span class="op">=</span><span class="fl">1e-7</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>process.plot_convergence(<span class="st">"outputs/convergence.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Stream</span> Tolerance <span class="at">-</span><span class="op">&gt;</span> 2.20e+00 <span class="at">-</span><span class="op">&gt;</span> 5.29e-01 <span class="at">-</span><span class="op">&gt;</span> 1.12e-01 <span class="at">-</span><span class="op">&gt;</span>...-<span class="op">&gt;</span> 9.47e-07 <span class="at">-</span><span class="op">&gt;</span> 3.83e-07 <span class="at">-</span><span class="op">&gt;</span> 1.54e-07</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Converged</span> in 30 iterations.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="convergence.png" class="img-fluid figure-img"></p>
<figcaption>Convergence of a process.</figcaption>
</figure>
</div>
</div><div id="fn16"><p><sup>16</sup>&nbsp;This is done by analysing streams to see if they come from, or go to a unit operation. If not, they are designated process inlet or outlets and quantities summed.</p></div></div><p>The overall mass and energy balance can be validated<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a>, and I can also print off the steady-state of the convergenced process.</p>
<div id="60d7e2f2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(process, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(process.confirm_energy_balance(), <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(process.confirm_mass_balance())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Show convergenced process information
</summary>
<div id="07c482ff" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Process(name<span class="op">=</span><span class="st">'nitrobenzene_process'</span>, unit_operations<span class="op">=</span>{<span class="st">'reactant_mixer'</span>: Mixer(name<span class="op">=</span><span class="st">'reactant_mixer'</span>, inlet<span class="op">=</span>[(<span class="fl">0.50</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'1.00'</span>}, (<span class="fl">0.50</span> kmol<span class="op">/</span>hr, <span class="fl">312.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'nitric_acid'</span>: <span class="st">'1.00'</span>}, (<span class="fl">0.26</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}, (<span class="fl">0.04</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'nitric_acid'</span>: <span class="st">'0.17'</span>, <span class="st">'water'</span>: <span class="st">'0.28'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.10'</span>, <span class="st">'benzene'</span>: <span class="st">'0.45'</span>}], outlet<span class="op">=</span>[(<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">300.92</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.41'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.39'</span>, <span class="st">'water'</span>: <span class="st">'0.10'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.10'</span>}], process<span class="op">=</span>...), <span class="st">'splitter_one'</span>: Splitter(name<span class="op">=</span><span class="st">'splitter_one'</span>, inlet<span class="op">=</span>[(<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}], outlet<span class="op">=</span>[(<span class="fl">1.04</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}, (<span class="fl">0.26</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}], process<span class="op">=</span>..., split_ratio<span class="op">=</span>[<span class="fl">0.8</span>, <span class="fl">0.2</span>]), <span class="st">'reactor_one'</span>: Reactor(name<span class="op">=</span><span class="st">'reactor_one'</span>, inlet<span class="op">=</span>[(<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">300.92</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.41'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.39'</span>, <span class="st">'water'</span>: <span class="st">'0.10'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.10'</span>}], outlet<span class="op">=</span>[(<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">367.04</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}], process<span class="op">=</span>..., reactant_stoichiometry<span class="op">=</span>{<span class="st">'benzene'</span>: <span class="dv">1</span>, <span class="st">'nitric_acid'</span>: <span class="dv">1</span>}, product_stoichiometry<span class="op">=</span>{<span class="st">'water'</span>: <span class="dv">1</span>, <span class="st">'nitro_benzene'</span>: <span class="dv">1</span>}, conversion<span class="op">=</span>{<span class="st">'benzene'</span>: <span class="fl">0.9</span>}, heat_of_reaction<span class="op">=</span><span class="fl">153180.0</span>), <span class="st">'product_cooler'</span>: HeatExchanger(name<span class="op">=</span><span class="st">'product_cooler'</span>, inlet<span class="op">=</span>[(<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">367.04</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}], outlet<span class="op">=</span>[(<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}], process<span class="op">=</span>..., outlet_temperature<span class="op">=</span><span class="dv">298</span>, delta_temperature<span class="op">=</span><span class="va">None</span>), <span class="st">'separator_one'</span>: Separator(name<span class="op">=</span><span class="st">'separator_one'</span>, inlet<span class="op">=</span>[(<span class="fl">1.04</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}], outlet<span class="op">=</span>[(<span class="fl">0.52</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.88'</span>, <span class="st">'water'</span>: <span class="st">'0.05'</span>}, (<span class="fl">0.53</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.05'</span>, <span class="st">'water'</span>: <span class="st">'0.89'</span>}], process<span class="op">=</span>..., spec<span class="op">=</span>[{<span class="st">'nitro_benzene'</span>: <span class="fl">0.95</span>}, {<span class="st">'water'</span>: <span class="fl">0.95</span>}]), <span class="st">'separator_two'</span>: Separator(name<span class="op">=</span><span class="st">'separator_two'</span>, inlet<span class="op">=</span>[(<span class="fl">0.52</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.88'</span>, <span class="st">'water'</span>: <span class="st">'0.05'</span>}], outlet<span class="op">=</span>[(<span class="fl">0.47</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'nitric_acid'</span>: <span class="st">'0.02'</span>, <span class="st">'water'</span>: <span class="st">'0.03'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.96'</span>, <span class="st">'benzene'</span>: <span class="st">'0.00'</span>}, (<span class="fl">0.04</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'nitric_acid'</span>: <span class="st">'0.17'</span>, <span class="st">'water'</span>: <span class="st">'0.28'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.10'</span>, <span class="st">'benzene'</span>: <span class="st">'0.45'</span>}], process<span class="op">=</span>..., spec<span class="op">=</span>[{<span class="st">'nitro_benzene'</span>: <span class="fl">0.99</span>}, {<span class="st">'benzene'</span>: <span class="fl">0.95</span>}])}, streams<span class="op">=</span>{<span class="st">'benzene_inlet'</span>: (<span class="fl">0.50</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'1.00'</span>}, <span class="st">'nitric_acid_inlet'</span>: (<span class="fl">0.50</span> kmol<span class="op">/</span>hr, <span class="fl">312.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'nitric_acid'</span>: <span class="st">'1.00'</span>}, <span class="st">'reactor_products'</span>: (<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">367.04</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}, <span class="st">'reactor_products_cooled'</span>: (<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}, <span class="st">'reactor_reactants'</span>: (<span class="fl">1.31</span> kmol<span class="op">/</span>hr, <span class="fl">300.92</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.41'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.39'</span>, <span class="st">'water'</span>: <span class="st">'0.10'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.10'</span>}, <span class="st">'final_product'</span>: (<span class="fl">1.04</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}, <span class="st">'tops'</span>: (<span class="fl">0.52</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.88'</span>, <span class="st">'water'</span>: <span class="st">'0.05'</span>}, <span class="st">'waste_water'</span>: (<span class="fl">0.53</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.05'</span>, <span class="st">'water'</span>: <span class="st">'0.89'</span>}, <span class="st">'pure_product'</span>: (<span class="fl">0.47</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'nitric_acid'</span>: <span class="st">'0.02'</span>, <span class="st">'water'</span>: <span class="st">'0.03'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.96'</span>, <span class="st">'benzene'</span>: <span class="st">'0.00'</span>}, <span class="st">'benzene_recycle'</span>: (<span class="fl">0.04</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'nitric_acid'</span>: <span class="st">'0.17'</span>, <span class="st">'water'</span>: <span class="st">'0.28'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.10'</span>, <span class="st">'benzene'</span>: <span class="st">'0.45'</span>}, <span class="st">'recycle'</span>: (<span class="fl">0.26</span> kmol<span class="op">/</span>hr, <span class="fl">298.00</span> K, <span class="fl">101325.00</span> Pa) {<span class="st">'benzene'</span>: <span class="st">'0.04'</span>, <span class="st">'nitric_acid'</span>: <span class="st">'0.03'</span>, <span class="st">'water'</span>: <span class="st">'0.47'</span>, <span class="st">'nitro_benzene'</span>: <span class="st">'0.46'</span>}}, species<span class="op">=</span>{<span class="st">'water'</span>: water (<span class="fl">18.01528</span> kg<span class="op">/</span>kmol), <span class="st">'benzene'</span>: benzene (<span class="fl">78.11</span> kg<span class="op">/</span>kmol), <span class="st">'nitric_acid'</span>: nitric_acid (<span class="fl">63.013</span> kg<span class="op">/</span>kmol), <span class="st">'nitro_benzene'</span>: nitro_benzene (<span class="fl">123.109</span> kg<span class="op">/</span>kmol)}, <span class="bu">print</span><span class="op">=</span><span class="va">True</span>, simulated_at<span class="op">=</span>datetime.datetime(<span class="dv">2024</span>, <span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">26</span>, <span class="dv">8</span>, <span class="dv">154480</span>, tzinfo<span class="op">=</span>datetime.timezone.utc)) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Enthalpy <span class="kw">in</span>: <span class="fl">37412.944</span> kJ,  Reaction Enthalpy: <span class="fl">73175.159</span> kJ, Enthalpy Added: <span class="op">-</span><span class="fl">38052.065</span> kJ, Enthalpy out: <span class="fl">72536.082</span> kJ</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Difference: <span class="op">-</span><span class="fl">0.043281</span> kJ (<span class="op">-</span><span class="fl">0.000116</span><span class="op">%</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="va">False</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Mass <span class="kw">in</span>: <span class="fl">70.561</span> kg, Mass out: <span class="fl">70.562</span> kg</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>Difference: <span class="op">-</span><span class="fl">0.000613</span> kg (<span class="op">-</span><span class="fl">0.000869</span><span class="op">%</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p>I can simulate heat exchangers, splitting streams, mixing streams, basic separations, non-adiabatic reactions with stoichiometric ratios, components with specific heat capacities as a funciton of temperature… this should be enough for now.</p>
</section>
<section id="now-what" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="now-what">Now what?</h3>
<p>The goal here is to build an input-output machine, that on the surface acts like the ‘room’ in the Chinese room, and more precisely, the waterworks within the room as proposed by Searle in his brain simulator scenario. To make this easier, when I say ‘think’, I mean I’m going to approximate a function, because as I previously mention, I don’t believe in the Chinese room argument.</p>
<p>I will go about doing this through <strong>direct simulation</strong> , where the chemical process is directly used to model a function via something analygous to symbolic regression or evolutionary programming.<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn17"><p><sup>17</sup>&nbsp;Alternative methods would be to either: 1. Build up the basic building blocks of computation, i.e.&nbsp;AND, OR, gates etc… Then by extension demonstrate how a computer can be constructed, and therefore a universal function approximator (2 layers of abstraction below thinking). Or… 2. Build up the basic building blocks of a neural network, which, as a universal function approximator, completes the ability to approximate functions (1 layer of abstraction below thinking). But as previously mentioned, I want the chemical process to be as close as possible to the function approximation task at hand. </p></div></div><p>Therefore, the mathematical problem I will solve will be a least-squares (machine learning) task over chemical processes:</p>
<p><span class="math display">\[
\min_{\mathcal{P}} \sum_{i=1}^N ||\mathcal{P}(x_i) - y_i||^2_2
\]</span></p>
<p>where a chemical process <span class="math inline">\(\mathcal{P}\)</span> is defined by a set of unit operations <span class="math inline">\(\mathcal{O}\)</span>, connecting streams <span class="math inline">\(\mathcal{S}\)</span>, yappa yappa blah blah blah… Basically, you choose what the input <span class="math inline">\(x\)</span> represents in your process, and what the output <span class="math inline">\(y\)</span> represents. Simulate the chemical process for a given <span class="math inline">\(x\)</span> and evaluate the output. Do this for all values of <span class="math inline">\(x\)</span> in the dataset and you can evaluate how well the process approximates the function.</p>
<p>That being said, I am going to solve this optimisation problem using evolutionary programming. Firstly, I’ll demonstrate a way of evaluating the objective function.</p>
<p>We need some data.</p>
<div id="1100f411" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="fl">1.5</span><span class="op">*</span>np.pi,n)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.sin(x) <span class="op">+</span> np.random.normal(<span class="dv">0</span>,<span class="fl">0.2</span>,n)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="aff5f546" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="491" height="203"></p>
</figure>
</div>
</div>
</div>
<p>To begin with I will define a very basic process with a single component as an inlet stream, a single component as an outlet stream, and a mixer that doesn’t do anything.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[species]]</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"water"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="dt">molecular_weight</span> <span class="op">=</span> <span class="fl">18.01528</span> <span class="co"># kg/kmol</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="dt">cp_poly_coeffs</span> <span class="op">=</span> <span class="op">[</span><span class="fl">276370.0</span><span class="op">,</span> <span class="fl">-2090.1</span><span class="op">,</span> <span class="fl">8.125</span><span class="op">,</span> <span class="fl">-0.014116</span><span class="op">,</span> <span class="fl">9.3701e-6</span><span class="op">]</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="dt">enthalpy_of_formation</span> <span class="op">=</span> <span class="fl">-285830.0</span> <span class="co"># kJ/kmol</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"inlet"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_flowrate</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># kmol</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="dt">molar_ratios</span> <span class="op">=</span> <span class="op">{</span><span class="dt">water</span><span class="op"> =</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="dt">temperature</span> <span class="op">=</span> <span class="dv">298</span> <span class="co"># K </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="dt">pressure</span> <span class="op">=</span> <span class="dv">101325</span> <span class="co"># Pa</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="kw">[[streams]]</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"outlet"</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="kw">[[mixer]]</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"mixer"</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"inlet"</span><span class="op">]</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"outlet"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="">
<p><img src="basic_process.png" class="img-fluid"></p>
</div></div><p>For now, assuming temperature of both the inlet stream and outlet stream represent my functional input and output respectively, I can simulate the process and evaluate the objective function as follows:</p>
<div id="dddae73c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> []</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    process.streams[<span class="st">'inlet'</span>].temperature <span class="op">=</span> x[i]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    process.simulate(tol<span class="op">=</span><span class="fl">1e-7</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    y_test.append(process.streams[<span class="st">'outlet'</span>].temperature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="basic_plot.png" class="img-fluid"></p>
<p>Can you see where we’re going yet?</p>
<p>I can take advantage of multiprocessing to evaluate the objective function in parallel. This is a strength of <code>&lt;process&gt;</code>, and is a good demonstration of designing something like a process simulator with machine learning use cases in mind.</p>
<p>I’ll assume that physical units can be scaled later on. Now I can hypothesise that there is a heat exchanger between the streams, with a given temperature decrease to get a different ‘loss’ between our data and the process output.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[heat_exchanger]]</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"product_cooler"</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="dt">inlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"inlet"</span><span class="op">]</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="dt">outlet</span> <span class="op">=</span> <span class="op">[</span><span class="st">"outlet"</span><span class="op">]</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="dt">delta_temperature</span> <span class="op">=</span> <span class="dv">-3</span> <span class="co"># K</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="">
<p><img src="basic_plot_temp.png" class="img-fluid"></p>
</div></div><p>I’ll stop here, we get the idea. We can change the type of unit operation, their internal parameters, and their order to try and approximate a function. Now we have the ability to:</p>
<ol type="1">
<li>Evaluate how well our process can approximate a function;</li>
<li>Mutate the process,<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></li>
</ol>
<div class="no-row-height column-margin column-container"><div id="fn18"><p><sup>18</sup>&nbsp;Once again, by building a lightweight process simulator we have gained the ability to easily modify the process structure enabling us to solve an optimisation problem over different structures, something that takes PhD lengths of time to do in Aspen or gProms.</p></div><div id="fn19"><p><sup>19</sup>&nbsp;Presented in an unnessiscarily complex amount of detail, remember?</p></div></div><p>We can build a basic evolutionary programming framework to solve the optimisation problem above<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>.</p>
<p>This is what I will do.</p>
<!-- # create a chemical process to draw an elephant and end on a deep point about modelling and machine learning and thinking and nature inspired computing. -->
<!-- discuss super structre optimisation and chemical implications leading to why process would be useful in the future -->
<!-- can a chemical process simulate a chemical process? -->
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>



</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sav\.phd");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="trsav/trsav.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>